<odoo>
  <data noupdate="0">

    <!-- Leads visíveis conforme allowed_user_ids -->
    <record id="rule_crm_lead_visibility" model="ir.rule">
        <field name="name">CRM Lead: Visibilidade pela hierarquia de unidades</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="domain_force">[('user_id', 'in', user.allowed_user_ids.ids)]</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Contatos visíveis se vinculados a leads permitidos -->
    <record id="rule_res_partner_sales_unit" model="ir.rule">
        <field name="name">Contatos visíveis conforme leads permitidos</field>
        <field name="model_id" ref="base.model_res_partner"/>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="domain_force">[('user_id', 'in', user.allowed_user_ids.ids)]</field>
        <field name="active" eval="True"/>
    </record>

  </data>
</odoo>
