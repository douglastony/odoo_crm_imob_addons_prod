<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- Corretor: vê apenas seus próprios leads -->
    <record id="rule_crm_lead_salesperson" model="ir.rule">
        <field name="name">CRM Lead: Corretores só veem seus leads</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="domain_force">[('user_id', '=', user.id)]</field>
    </record>

    <!-- Coordenador: vê leads de sua coordenação -->
    <record id="rule_crm_lead_coordinator" model="ir.rule">
        <field name="name">CRM Lead: Coordenador vê sua coordenação</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('crm_sales_unit.group_coordinator'))]"/>
        <field name="domain_force">
            [
                '|',
                ('user_id', '=', user.id),
                ('user_id.sales_unit_id', '=', user.sales_unit_id.id)
            ]
        </field>
    </record>

    <!-- Gerente: vê leads da gerência e coordenações abaixo -->
    <record id="rule_crm_lead_manager" model="ir.rule">
        <field name="name">CRM Lead: Gerente vê sua gerência + coordenações</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('crm_sales_unit.group_manager'))]"/>
        <field name="domain_force">
            [
                '|',
                ('user_id', '=', user.id),
                ('user_id.sales_unit_id', 'child_of', user.sales_unit_id.id)
            ]
        </field>
    </record>

    <!-- Diretor: vê leads da diretoria e descendentes -->
    <record id="rule_crm_lead_director" model="ir.rule">
        <field name="name">CRM Lead: Diretor vê diretoria + descendentes</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('crm_sales_unit.group_director'))]"/>
        <field name="domain_force">
            [
                '|',
                ('user_id', '=', user.id),
                ('user_id.sales_unit_id', 'child_of', user.sales_unit_id.id)
            ]
        </field>
    </record>

    <!-- Sócio: vê todos os leads -->
    <record id="rule_crm_lead_president" model="ir.rule">
        <field name="name">CRM Lead: Sócio vê todos os leads</field>
        <field name="model_id" ref="crm.model_crm_lead"/>
        <field name="groups" eval="[(4, ref('crm_sales_unit.group_president'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
    </record>

</odoo>
