<odoo>
    <data>
        <!-- View Form para Configuração de Expediente -->
        <record id="view_crm_sales_unit_config_form" model="ir.ui.view">
            <field name="name">crm.sales.unit.config.form</field>
            <field name="model">crm.sales.unit.config</field>
            <field name="arch" type="xml">
                <form string="Configuração de Expediente" create="false" delete="false">
                    <sheet>
                        <group>
                            <field name="start_time" widget="float_time"/>
                            <field name="end_time" widget="float_time"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Ação servidor que abre o único registro de configuração -->
        <record id="action_open_crm_sales_unit_config" model="ir.actions.server">
            <field name="name">Editar Horário de Expediente</field>
            <field name="model_id" ref="model_crm_sales_unit_config"/>
            <field name="state">code</field>
            <field name="code"><![CDATA[
config = env['crm.sales.unit.config'].search([], limit=1)
if not config:
    config = env['crm.sales.unit.config'].create({
        'start_time': 13.0,
        'end_time': 21.0,
    })
action = {
    'type': 'ir.actions.act_window',
    'name': 'Horário de Expediente',
    'res_model': 'crm.sales.unit.config',
    'view_mode': 'form',
    'res_id': config.id,
    'view_id': env.ref('crm_sales_unit.view_crm_sales_unit_config_form').id,
    'target': 'current',
}
            ]]></field>
        </record>

        <!-- Menu para Configuração de Expediente -->
        <menuitem id="menu_crm_sales_unit_config_hours"
                  name="Horário de Expediente"
                  parent="menu_crm_sales_unit_config"
                  action="action_open_crm_sales_unit_config"
                  sequence="5"/>

        <!-- Ação de Janela para Localizações Permitidas -->
        <record id="action_crm_sales_unit_location" model="ir.actions.act_window">
            <field name="name">Localizações Permitidas</field>
            <field name="res_model">crm.sales.unit.location</field>
            <field name="view_mode">list,form</field>
        </record>

        <!-- View list para Localizações Permitidas -->
        <record id="view_crm_sales_unit_location_list" model="ir.ui.view">
            <field name="name">crm.sales.unit.location.list</field>
            <field name="model">crm.sales.unit.location</field>
            <field name="arch" type="xml">
                <list string="Localizações Permitidas">
                    <field name="name"/>
                    <field name="latitude"/>
                    <field name="longitude"/>
                    <field name="radius"/>
                </list>
            </field>
        </record>

        <!-- View Form para Localizações Permitidas -->
        <record id="view_crm_sales_unit_location_form" model="ir.ui.view">
            <field name="name">crm.sales.unit.location.form</field>
            <field name="model">crm.sales.unit.location</field>
            <field name="arch" type="xml">
                <form string="Localização Permitida">
                    <sheet>
                        <group>
                            <field name="name"/>
                            <field name="latitude"/>
                            <field name="longitude"/>
                            <field name="radius"/>
                        </group>
                        <p class="o_form_label">
                            <i class="fa fa-info-circle"/> O raio de tolerância é a distância máxima (em metros) que o usuário pode estar do ponto central para que o check-in seja validado.
                        </p>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Ação de Janela para IPs Permitidos -->
        <record id="action_crm_sales_unit_ip" model="ir.actions.act_window">
            <field name="name">IPs/Ranges Permitidos</field>
            <field name="res_model">crm.sales.unit.ip</field>
            <field name="view_mode">list,form</field>
        </record>

        <!-- View list para IPs Permitidos -->
        <record id="view_crm_sales_unit_ip_list" model="ir.ui.view">
            <field name="name">crm.sales.unit.ip.list</field>
            <field name="model">crm.sales.unit.ip</field>
            <field name="arch" type="xml">
                <list string="IPs/Ranges Permitidos">
                    <field name="cidr"/>
                </list>
            </field>
        </record>

        <!-- View Form para IPs Permitidos -->
        <record id="view_crm_sales_unit_ip_form" model="ir.ui.view">
            <field name="name">crm.sales.unit.ip.form</field>
            <field name="model">crm.sales.unit.ip</field>
            <field name="arch" type="xml">
                <form string="IP ou Range Permitido">
                    <sheet>
                        <group>
                            <field name="cidr" string="IP ou Range (CIDR)"/>
                        </group>
                        <p class="o_form_label">
                            <i class="fa fa-info-circle"/> Informe um IP único (ex.: 177.27.6.243) ou um range CIDR (ex.: 177.27.0.0/16).
                        </p>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Menu de Configuração -->
        <menuitem id="menu_crm_sales_unit_config"
                  name="Configurações de Unidade"
                  parent="crm.crm_menu_root"
                  sequence="100"
                  groups="crm_sales_unit.group_president"/>

        <menuitem id="menu_crm_sales_unit_location"
                  name="Localizações"
                  parent="menu_crm_sales_unit_config"
                  action="action_crm_sales_unit_location"
                  sequence="10"/>

        <menuitem id="menu_crm_sales_unit_ip"
                  name="IPs/Ranges"
                  parent="menu_crm_sales_unit_config"
                  action="action_crm_sales_unit_ip"
                  sequence="20"/>
    </data>
</odoo>
